<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>&#x2F;obj&#x2F;machinery - &#x2F;tg&#x2F; Station 13</title>
</head>
<body>
<header>
    <a href="index.html">&#x2F;tg&#x2F; Station 13</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
 &mdash; <a href="obj/machinery.html#var">Var Details</a> - <a href="obj/machinery.html#proc">Proc Details</a></header>
<main>
<h1>machinery <aside>/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a></aside>
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L83">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 83"/></a></h1>

<p>Machines in the world, such as computers, pipes, and airlocks.</p>
<p>Overview:
Used to create objects that need a per step proc call.  Default definition of 'Initialize()'
stores a reference to src machine in global 'machines list'.  Default definition
of 'Destroy' removes reference to src machine in global 'machines list'.</p>
<p>Class Variables:
use_power (num)
current state of auto power use.
Possible Values:
NO_POWER_USE -- no auto power use
IDLE_POWER_USE -- machine is using power at its idle power level
ACTIVE_POWER_USE -- machine is using power at its active power level</p>
<p>active_power_usage (num)
Value for the amount of power to use when in active power mode</p>
<p>idle_power_usage (num)
Value for the amount of power to use when in idle power mode</p>
<p>power_channel (num)
What channel to draw from when drawing power for power mode
Possible Values:
AREA_USAGE_EQUIP:0 -- Equipment Channel
AREA_USAGE_LIGHT:2 -- Lighting Channel
AREA_USAGE_ENVIRON:3 -- Environment Channel</p>
<p>component_parts (list)
A list of component parts of machine used by frame based machines.</p>
<p>stat (bitflag)
Machine status bit flags.
Possible bit flags:
BROKEN -- Machine is broken
NOPOWER -- No power is being supplied to machine.
MAINT -- machine is currently under going maintenance.
EMPED -- temporary broken by EMP pulse</p>
<p>Class Procs:
Initialize()                     'game/machinery/machine.dm'</p>
<p>Destroy()                   'game/machinery/machine.dm'</p>
<p>auto_use_power()            'game/machinery/machine.dm'
This proc determines how power mode power is deducted by the machine.
'auto_use_power()' is called by the 'master_controller' game_controller every
tick.</p>
<pre><code> Return Value:
    return:1 -- if object is powered
    return:0 -- if object is not powered.

 Default definition uses 'use_power', 'power_channel', 'active_power_usage',
 'idle_power_usage', 'powered()', and 'use_power()' implement behavior.
</code></pre>
<p>powered(chan = -1)         'modules/power/power.dm'
Checks to see if area that contains the object has power available for power
channel given in 'chan'. -1 defaults to power_channel</p>
<p>use_power(amount, chan=-1)   'modules/power/power.dm'
Deducts 'amount' from the power channel 'chan' of the area that contains the object.</p>
<p>power_change()               'modules/power/power.dm'
Called by the area that contains the object when ever that area under goes a
power state change (area runs out of power, or area channel is turned off).</p>
<p>RefreshParts()               'game/machinery/machine.dm'
Called to refresh the variables in the machine that are contributed to by parts
contained in the component_parts list. (example: glass and material amounts for
the autolathe)</p>
<pre><code> Default definition does nothing.
</code></pre>
<p>process()                  'game/machinery/machine.dm'
Called by the 'machinery subsystem' once per machinery tick for each machine that is listed in its 'machines' list.</p>
<p>process_atmos()
Called by the 'air subsystem' once per atmos tick for each machine that is listed in its 'atmos_machines' list.
Compiled by Aygar</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr>
            <tr><th><a href="obj/machinery.html#var/atmos_processing">atmos_processing</a></th><td>Is this machine currently in the atmos machinery queue?</td></tr>
            <tr><th><a href="obj/machinery.html#var/is_operational">is_operational</a></th><td>A combination of factors such as having power, not being broken and so on. Boolean.</td></tr>
            <tr><th><a href="obj/machinery.html#var/last_used_time">last_used_time</a></th><td>world.time of last use by <a href="mob/living.html" title="/mob/living">/mob/living</a></td></tr>
            <tr><th><a href="obj/machinery.html#var/last_user_mobtype">last_user_mobtype</a></th><td>Mobtype of last user. Typecast to <a href="mob/living.html" title="/mob/living">/mob/living</a> for initial() usage</td></tr>
            <tr><th><a href="obj/machinery.html#var/processing_flags">processing_flags</a></th><td>Viable flags to go here are START_PROCESSING_ON_INIT, or START_PROCESSING_MANUALLY. See code__DEFINES\machines.dm for more information on these flags.</td></tr>
            <tr><th><a href="obj/machinery.html#var/subsystem_type">subsystem_type</a></th><td>What subsystem this machine will use, which is generally SSmachines or SSfastprocess. By default all machinery use SSmachines. This fires a machine's process() roughly every 2 seconds.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr>
            <tr><th><a href="obj/machinery.html#proc/AI_notify_hack">AI_notify_hack</a></th><td>Alerts the AI that a hack is in progress.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/begin_processing">begin_processing</a></th><td>Helper proc for telling a machine to start processing with the subsystem type that is located in its <code>subsystem_type</code> var.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/directly_use_power">directly_use_power</a></th><td>An alternative to 'use_power', this proc directly costs the APC in direct charge, as opposed to being calculated periodically.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/dump_contents">dump_contents</a></th><td>Drop every movable atom in the machine's contents list, including any components and circuit.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/dump_inventory_contents">dump_inventory_contents</a></th><td>Drop every movable atom in the machine's contents list that is not a component_part.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/end_processing">end_processing</a></th><td>Helper proc for telling a machine to stop processing with the subsystem type that is located in its <code>subsystem_type</code> var.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/on_set_is_operational">on_set_is_operational</a></th><td>Called when the value of <code>is_operational</code> changes, so we can react to it.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/on_set_machine_stat">on_set_machine_stat</a></th><td>Called when the value of <code>machine_stat</code> changes, so we can react to it.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/open_machine">open_machine</a></th><td>Opens the machine.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/power_change">power_change</a></th><td>Called whenever the power settings of the containing area change</td></tr>
            <tr><th><a href="obj/machinery.html#proc/set_is_operational">set_is_operational</a></th><td>Called when we want to change the value of the <code>is_operational</code> variable. Boolean.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/set_machine_stat">set_machine_stat</a></th><td>Called when we want to change the value of the machine_stat variable. Holds bitflags.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/spawn_frame">spawn_frame</a></th><td>Spawns a frame where this machine is. If the machine was not disassmbled, the
frame is spawned damaged. If the frame couldn't exist on this turf, it's smashed
down to metal sheets.</td></tr>
            <tr><th><a href="obj/machinery.html#proc/try_put_in_hand">try_put_in_hand</a></th><td>Puts passed object in to user's hand</td></tr>
            <tr><th><a href="obj/machinery.html#proc/use_power_from_net">use_power_from_net</a></th><td>Attempts to draw power directly from the APC's Powernet rather than the APC's battery. For high-draw machines, like the cell charger</td></tr></table>
    <h2 id="var">Var Details</h2><h3 id="var/atmos_processing"><aside class="declaration">var </aside>atmos_processing
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L133">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 133"/></a></h3>
        <p>Is this machine currently in the atmos machinery queue?</p><h3 id="var/is_operational"><aside class="declaration">var </aside>is_operational
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L110">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 110"/></a></h3>
        <p>A combination of factors such as having power, not being broken and so on. Boolean.</p><h3 id="var/last_used_time"><aside class="declaration">var </aside>last_used_time
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L135">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 135"/></a></h3>
        <p>world.time of last use by <a href="mob/living.html" title="/mob/living">/mob/living</a></p><h3 id="var/last_user_mobtype"><aside class="declaration">var </aside>last_user_mobtype
            <aside>&ndash; /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a></aside>
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L139">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 139"/></a></h3>
        <p>Mobtype of last user. Typecast to <a href="mob/living.html" title="/mob/living">/mob/living</a> for initial() usage</p><h3 id="var/processing_flags"><aside class="declaration">var </aside>processing_flags
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L120">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 120"/></a></h3>
        <p>Viable flags to go here are START_PROCESSING_ON_INIT, or START_PROCESSING_MANUALLY. See code__DEFINES\machines.dm for more information on these flags.</p><h3 id="var/subsystem_type"><aside class="declaration">var </aside>subsystem_type
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L122">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 122"/></a></h3>
        <p>What subsystem this machine will use, which is generally SSmachines or SSfastprocess. By default all machinery use SSmachines. This fires a machine's process() roughly every 2 seconds.</p><h2 id="proc">Proc Details</h2><h3 id="proc/AI_notify_hack"><aside class="declaration">proc </aside>AI_notify_hack<aside>() 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L809">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 809"/></a></aside>
        </h3>
        <p>Alerts the AI that a hack is in progress.</p>
<p>Sends all AIs a message that a hack is occurring.  Specifically used for space ninja tampering as this proc was originally in the ninja files.
However, the proc may also be used elsewhere.</p><h3 id="proc/begin_processing"><aside class="declaration">proc </aside>begin_processing<aside>() 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L164">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 164"/></a></aside>
        </h3>
        <p>Helper proc for telling a machine to start processing with the subsystem type that is located in its <code>subsystem_type</code> var.</p><h3 id="proc/directly_use_power"><aside class="declaration">proc </aside>directly_use_power<aside>(amount) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/modules/power/power.dm#L108">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;power.dm 108"/></a></aside>
        </h3>
        <p>An alternative to 'use_power', this proc directly costs the APC in direct charge, as opposed to being calculated periodically.</p>
<ul>
<li>Amount: How much power the APC's cell is to be costed.</li>
</ul><h3 id="proc/dump_contents">dump_contents<aside>() 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L239">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 239"/></a></aside>
        </h3>
        <p>Drop every movable atom in the machine's contents list, including any components and circuit.</p><h3 id="proc/dump_inventory_contents"><aside class="declaration">proc </aside>dump_inventory_contents<aside>(/list/subset) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L262">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 262"/></a></aside>
        </h3>
        <p>Drop every movable atom in the machine's contents list that is not a component_part.</p>
<p>Proc does not drop components and will skip over anything in the component_parts list.
Call dump_contents() to drop all contents including components.
Arguments:</p>
<ul>
<li>subset - If this is not null, only atoms that are also contained within the subset list will be dropped.</li>
</ul><h3 id="proc/end_processing"><aside class="declaration">proc </aside>end_processing<aside>() 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L169">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 169"/></a></aside>
        </h3>
        <p>Helper proc for telling a machine to stop processing with the subsystem type that is located in its <code>subsystem_type</code> var.</p><h3 id="proc/on_set_is_operational"><aside class="declaration">proc </aside>on_set_is_operational<aside>(old_value) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L338">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 338"/></a></aside>
        </h3>
        <p>Called when the value of <code>is_operational</code> changes, so we can react to it.</p><h3 id="proc/on_set_machine_stat"><aside class="declaration">proc </aside>on_set_machine_stat<aside>(old_value) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L207">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 207"/></a></aside>
        </h3>
        <p>Called when the value of <code>machine_stat</code> changes, so we can react to it.</p><h3 id="proc/open_machine"><aside class="declaration">proc </aside>open_machine<aside>(drop) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L228">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 228"/></a></aside>
        </h3>
        <p>Opens the machine.</p>
<p>Will update the machine icon and any user interfaces currently open.
Arguments:</p>
<ul>
<li>drop - Boolean. Whether to drop any stored items in the machine. Does not include components.</li>
</ul><h3 id="proc/power_change"><aside class="declaration">proc </aside>power_change<aside>() 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/modules/power/power.dm#L171">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;power.dm 171"/></a></aside>
        </h3>
        <p>Called whenever the power settings of the containing area change</p>
<p>by default, check equipment channel &amp; set flag, can override if needed</p>
<p>Returns TRUE if the NOPOWER flag was toggled</p><h3 id="proc/set_is_operational"><aside class="declaration">proc </aside>set_is_operational<aside>(new_value) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L329">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 329"/></a></aside>
        </h3>
        <p>Called when we want to change the value of the <code>is_operational</code> variable. Boolean.</p><h3 id="proc/set_machine_stat"><aside class="declaration">proc </aside>set_machine_stat<aside>(new_value) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L198">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 198"/></a></aside>
        </h3>
        <p>Called when we want to change the value of the machine_stat variable. Holds bitflags.</p><h3 id="proc/spawn_frame"><aside class="declaration">proc </aside>spawn_frame<aside>(disassembled) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L559">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 559"/></a></aside>
        </h3>
        <p>Spawns a frame where this machine is. If the machine was not disassmbled, the
frame is spawned damaged. If the frame couldn't exist on this turf, it's smashed
down to metal sheets.</p>
<p>Arguments:</p>
<ul>
<li>disassembled - If FALSE, the machine was destroyed instead of disassembled and the frame spawns at reduced integrity.</li>
</ul><h3 id="proc/try_put_in_hand"><aside class="declaration">proc </aside>try_put_in_hand<aside>(/<a href="obj.html">obj</a>/object, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/game/machinery/_machinery.dm#L286">
        <img src="git.png" width="16" height="16" title="code&#x2F;game&#x2F;machinery&#x2F;_machinery.dm 286"/></a></aside>
        </h3>
        <p>Puts passed object in to user's hand</p>
<p>Puts the passed object in to the users hand if they are adjacent.
If the user is not adjacent then place the object on top of the machine.</p>
<p>Vars:</p>
<ul>
<li>object (obj) The object to be moved in to the users hand.</li>
<li>user (mob/living) The user to recive the object</li>
</ul><h3 id="proc/use_power_from_net"><aside class="declaration">proc </aside>use_power_from_net<aside>(amount, take_any) 
        
    
            <a href="https://github.com/AetherStation/AetherStation13/blob/73b528b6815442f9d462741b5a955404a2d019c0/code/modules/power/power.dm#L132">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;power.dm 132"/></a></aside>
        </h3>
        <p>Attempts to draw power directly from the APC's Powernet rather than the APC's battery. For high-draw machines, like the cell charger</p>
<p>Checks the surplus power on the APC's powernet, and compares to the requested amount. If the requested amount is available, this proc
will add the amount to the APC's usage and return that amount. Otherwise, this proc will return FALSE.
If the take_any var arg is set to true, this proc will use and return any surplus that is under the requested amount, assuming that
the surplus is above zero.
Args:</p>
<ul>
<li>amount, the amount of power requested from the Powernet. In standard loosely-defined SS13 power units.</li>
<li>take_any, a bool of whether any amount of power is acceptable, instead of all or nothing. Defaults to FALSE</li>
</ul></main>
<footer>
    tgstation.dme
    <a href="https://github.com/AetherStation/AetherStation13/tree/73b528b6815442f9d462741b5a955404a2d019c0">73b528b</a>
        (master) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.8.0</a></footer>
</body>
</html>
